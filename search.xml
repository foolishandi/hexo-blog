<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ES6+进阶</title>
    <url>/hexo-blog/2022/07/24/ES6/</url>
    <content><![CDATA[<div class="note success simple"><h2 id="语言进阶"><a href="#语言进阶" class="headerlink" title="语言进阶"></a>语言进阶</h2></div>

<div class="note simple"><p><a href="https://www.runoob.com/jsref/jsref-obj-array.html">js初步入门学习</a><br><a href="https://blog.csdn.net/ciel_2/article/details/113195335?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165867868116782388081673%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165867868116782388081673&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-113195335-null-null.142%5Ev33%5Enew_blog_pos_by_title,185%5Ev2%5Econtrol&utm_term=es6%E6%96%B0%E7%89%B9%E6%80%A7&spm=1018.2226.3001.4187">ES6新特性</a><br><a href="https://es6.ruanyifeng.com/">更多内容，见：阮一峰老师的 es6 讲解</a></p>
</div>

<div class="tabs" id="first"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#first-1">Array</button></li><li class="tab"><button type="button" data-href="#first-2">setTimeout</button></li><li class="tab"><button type="button" data-href="#first-3">JSON.stringify</button></li><li class="tab"><button type="button" data-href="#first-4">模板字符串</button></li><li class="tab"><button type="button" data-href="#first-5">错误处理</button></li><li class="tab"><button type="button" data-href="#first-6">AOP切片</button></li><li class="tab"><button type="button" data-href="#first-7">防抖与节流</button></li><li class="tab"><button type="button" data-href="#first-8">柯里化与反柯里化</button></li><li class="tab"><button type="button" data-href="#first-9">继承与new</button></li><li class="tab"><button type="button" data-href="#first-10">深浅拷贝</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="first-1"><p><mark class="hl-label blue">常用方法</mark> </p>
<div class="note simple"><p><mark class="hl-label green">初始化数组</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="number">1.</span>新建一维数组</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>).<span class="title function_">fill</span>(<span class="number">0</span>) <span class="comment">// &gt;[0,0,0,0,0]</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>新建二维数组</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>).<span class="title function_">fill</span>(<span class="number">0</span>).<span class="title function_">map</span>(<span class="function"><span class="params">e</span>=&gt;</span><span class="keyword">new</span> <span class="title class_">Array</span>(<span class="number">5</span>).<span class="title function_">fill</span>(<span class="number">0</span>))</span><br><span class="line"><span class="comment">// &gt;[</span></span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>转化类数组</span><br><span class="line"><span class="title class_">LikeArray</span> 可以是 dom 元素组，<span class="variable language_">arguments</span>，<span class="title class_">Map</span>，<span class="title class_">Set</span> 和布置了 iterate 接口的对象等</span><br><span class="line">方式一:</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="title class_">LikeArray</span>)</span><br><span class="line">方式二:</span><br><span class="line">[...<span class="title class_">LikeArray</span>]</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">返回可迭代对象</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">一般用于对象,普通对象不方便直接遍历，可以转换成数组再遍历</span><br><span class="line"><span class="attr">eg</span>:<span class="keyword">let</span> fruits = [<span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Mango&quot;</span>]; <span class="number">1.</span>返回对象[key,value]的二维数组</span><br><span class="line">方式一:[...fruits.<span class="title function_">entries</span>()]</span><br><span class="line">方式二:<span class="title class_">Object</span>.<span class="title function_">entries</span>(fruits)</span><br><span class="line"><span class="comment">// &gt;[</span></span><br><span class="line">[<span class="number">0</span>, <span class="string">&quot;Banana&quot;</span>],</span><br><span class="line">[<span class="number">1</span>, <span class="string">&quot;Orange&quot;</span>],</span><br><span class="line">[<span class="number">2</span>, <span class="string">&quot;Apple&quot;</span>],</span><br><span class="line">[<span class="number">3</span>, <span class="string">&quot;Mango&quot;</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>返回对象的 key 数组</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(fruits) <span class="comment">// &gt;[&#x27;0&#x27;,&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>返回对象的 values 数组</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">values</span>(fruits) <span class="comment">// &gt;[&quot;Banana&quot;,&quot;Orange&quot;,&quot;Apple&quot;,&quot;Mango&quot;]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">数组检查与过滤</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>数组检查</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr) <span class="comment">//判断是不是数组 &gt;true</span></span><br><span class="line">arr.<span class="title function_">every</span>(<span class="function"><span class="params">e</span>=&gt;</span>e&gt;<span class="number">10</span>) <span class="comment">//每个数都大于 10? &gt;false</span></span><br><span class="line">arr.<span class="title function_">some</span>(<span class="function"><span class="params">e</span>=&gt;</span>e&gt;<span class="number">8</span>) <span class="comment">//存在大于 8 的元素? &gt;true</span></span><br><span class="line">arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">e</span>=&gt;</span>e===<span class="number">3</span>) <span class="comment">//找到第一个 3 的位置，没有就返回-1 &gt;3</span></span><br><span class="line">arr.<span class="title function_">indexOf</span>(<span class="number">3</span>) <span class="comment">//找到第一个 3 的位置，没有就返回-1 &gt;3</span></span><br><span class="line">arr.<span class="title function_">includes</span>(<span class="number">3</span>) <span class="comment">//是否包含 3? &gt;true</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>数组过滤</span><br><span class="line">arr.<span class="title function_">find</span>(<span class="function"><span class="params">e</span>=&gt;</span>e&gt;<span class="number">3</span>) <span class="comment">//返回第一个大于 3 的值 &gt;4</span></span><br><span class="line">arr.<span class="title function_">filter</span>(<span class="function"><span class="params">e</span>=&gt;</span>e&gt;<span class="number">3</span>) <span class="comment">//返回所有大于 3 的值 &gt;[4,5,6,7,8,9]</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">数组映射、遍历与截取</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">映射与截取不会改变原数组</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="keyword">let</span> flatArr=[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span><span class="keyword">let</span> arr1=arr.<span class="title function_">slice</span>(<span class="number">0</span>,<span class="number">3</span>) <span class="comment">//返回新数组[0,1,2]</span></span><br><span class="line"><span class="keyword">let</span> arr2=arr.<span class="title function_">slice</span>(<span class="number">1</span>) <span class="comment">// &gt;[1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="keyword">let</span> arr3=arr.<span class="title function_">slice</span>(-<span class="number">1</span>) <span class="comment">// &gt;[9]</span></span><br><span class="line"><span class="keyword">let</span> arr4=arr.<span class="title function_">slice</span>(<span class="number">1</span>,-<span class="number">1</span>) <span class="comment">// &gt;[1,2,3,4,5,6,7,8]</span></span><br><span class="line"><span class="number">2.</span><span class="keyword">let</span> arr5=arr.<span class="title function_">map</span>(<span class="function"><span class="params">e</span>=&gt;</span>e*<span class="number">2</span>) <span class="comment">//返回新数组[0,2,4,6,8,10,12,14,16,18]</span></span><br><span class="line"><span class="number">3.</span>arr.<span class="title function_">forEach</span>(<span class="function"><span class="params">e</span>=&gt;</span>e*<span class="number">2</span>) <span class="comment">//无返回值只是遍历计算，一般情况下不可停止</span></span><br><span class="line"><span class="number">4.</span><span class="keyword">let</span> arr6=flatArr.<span class="title function_">flat</span>() <span class="comment">// &gt;arr6=[1,2,3,4,5,1]</span></span><br><span class="line"><span class="number">5.</span><span class="keyword">let</span> arr7=arr.<span class="title function_">concat</span>([-<span class="number">1</span>,-<span class="number">2</span>]) <span class="comment">// &gt;arr7=[0,1,2,3,4,5,6,7,8,9,-1,-2]</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">数组操作</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">数组操作会改变原数组</span><br><span class="line"><span class="keyword">let</span> arr=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span><span class="keyword">let</span> a=arr.<span class="title function_">shift</span>()</span><br><span class="line"><span class="comment">//删除数组第一个元素 0,赋值给 a，所以:a=0;arr=[1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="keyword">let</span> b=arr.<span class="title function_">unshift</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="comment">//向 arr 最前面依次插入 1,2,3，返回新数组长度，所以:</span></span><br><span class="line"><span class="comment">//b=13,arr=[1,2,3,0,1,2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="number">2.</span><span class="keyword">let</span> c=arr.<span class="title function_">pop</span>() <span class="comment">//尾部删除 &gt;c=9</span></span><br><span class="line"><span class="keyword">let</span> d=arr.<span class="title function_">push</span>(<span class="number">1</span>) <span class="comment">//尾部插入 &gt;d=11</span></span><br><span class="line"><span class="number">3.</span>arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">//从索引 1 处开始，删除 2 个元素 &gt;arr=[0,3,4,5,6,7,8,9]</span></span><br><span class="line">arr.<span class="title function_">splice</span>(<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">2</span>) <span class="comment">//删除 2 个，再插入 2 个 &gt;arr=[0,-1,-2,3,4,5,6,7,8,9]</span></span><br><span class="line"><span class="number">4.</span>arr.<span class="title function_">reverse</span>() <span class="comment">// &gt;arr=[9,8,7,6,5,4,3,2,1,0]</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">数组排序、去重</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1=[<span class="number">2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">7</span>]</span><br><span class="line"><span class="keyword">let</span> arr2=[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">1</span>]]</span><br><span class="line"><span class="keyword">let</span> obj=[&#123;<span class="attr">c</span>:<span class="number">1</span>&#125;,&#123;<span class="attr">c</span>:<span class="number">5</span>&#125;,&#123;<span class="attr">c</span>:<span class="number">3</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>arr1.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a-b) <span class="comment">//会改变原数组 &gt;arr1=[1,2,2,3,4,4,7]</span></span><br><span class="line"><span class="number">2.</span>arr2.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a[<span class="number">0</span>]-a[<span class="number">0</span>]) <span class="comment">// &gt;arr2=[[1,2],[3,4],[5,1]]</span></span><br><span class="line">arr2.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a[<span class="number">1</span>]-a[<span class="number">1</span>]) <span class="comment">// &gt;arr2=[[5,1],[1,2],[3,4]</span></span><br><span class="line">obj.<span class="title function_">sort</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a.<span class="property">c</span>-b.<span class="property">c</span>) <span class="comment">// &gt;obj=[&#123;c:1&#125;,&#123;c:3&#125;,&#123;c:5&#125;]</span></span><br><span class="line"><span class="number">3.</span><span class="keyword">let</span> arr0=[...<span class="keyword">new</span> <span class="title class_">Set</span>(arr1)] <span class="comment">//去重 &gt;arr0=[2,1,3,4,5,7]</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">reduce</mark> </p>
<p>语法:<br><strong>arr.reduce(callback(accumulator, currentValue[, index[, array]])[, initialValue])</strong></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="number">1.</span>求和</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">sum</span>=(<span class="params">...res</span>)=&gt;res.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a,b</span>)=&gt;</span>a+b,res.<span class="property">length</span>===<span class="number">0</span> &amp;&amp; <span class="number">0</span>)</span><br><span class="line"><span class="attr">eg</span>:</span><br><span class="line"><span class="title function_">sum</span>() <span class="comment">// &gt;0</span></span><br><span class="line"><span class="title function_">sum</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment">// &gt;6</span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>二维数组变一维化</span><br><span class="line"><span class="keyword">let</span> flattened = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]].<span class="title function_">reduce</span>(<span class="function">(<span class="params"> acc, cur </span>) =&gt;</span> acc.<span class="title function_">concat</span>(cur),[]);</span><br><span class="line"><span class="comment">// &gt; [0, 1, 2, 3, 4, 5]</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>管道函数</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">pipe</span>=(<span class="params">...fns</span>)=&gt;<span class="function">(<span class="params">init</span>)=&gt;</span>fns.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre,fn</span>)=&gt;</span><span class="title function_">fn</span>(pre),init)</span><br><span class="line"><span class="attr">eg</span>:</span><br><span class="line"><span class="title function_">pipe</span>(<span class="function"><span class="params">x</span>=&gt;</span>x\*<span class="number">2</span>,<span class="function"><span class="params">x</span>=&gt;</span>x\*\*<span class="number">2</span>)(<span class="number">2</span>) <span class="comment">// &gt;16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//利用代理实现链式操作</span></span><br><span class="line"><span class="keyword">var</span> pipe = <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> funcStack = [];</span><br><span class="line">  <span class="keyword">var</span> oproxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125; , &#123;</span><br><span class="line">    get : <span class="keyword">function</span> (<span class="params">pipeObject, fnName</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (fnName === <span class="string">&#x27;get&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> funcStack.<span class="title function_">reduce</span>(<span class="keyword">function</span> (<span class="params">val, fn</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title function_">fn</span>(val);</span><br><span class="line">        &#125;,value);</span><br><span class="line">      &#125;</span><br><span class="line">      funcStack.<span class="title function_">push</span>(<span class="variable language_">window</span>[fnName]);</span><br><span class="line">      <span class="keyword">return</span> oproxy;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> oproxy;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">double</span> = n =&gt; n * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">pow</span>    = n =&gt; n * n;</span><br><span class="line"><span class="keyword">var</span> <span class="title function_">reverseInt</span> = n =&gt; n.<span class="title function_">toString</span>().<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>) | <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">pipe</span>(<span class="number">3</span>).<span class="property">double</span>.<span class="property">pow</span>.<span class="property">reverseInt</span>.<span class="property">get</span>; <span class="comment">// 63</span></span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>统计数组重复元素个数</span><br><span class="line"><span class="keyword">const</span> nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> count=nums.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre,num</span>)=&gt;</span>&#123;</span><br><span class="line">pre[num]=(pre[num] || <span class="number">0</span>)+<span class="number">1</span></span><br><span class="line"><span class="keyword">return</span> pre</span><br><span class="line">&#125;,&#123;&#125;)</span><br><span class="line"><span class="comment">// &gt;&#123;1: 1, 2: 2, 3: 3, 4: 2, 5: 1&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>按属性分组对象</span><br><span class="line"><span class="keyword">let</span> people = [</span><br><span class="line">&#123; <span class="attr">name</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="attr">age</span>: <span class="number">21</span> &#125;,</span><br><span class="line">&#123; <span class="attr">name</span>: <span class="string">&#x27;Max&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;,</span><br><span class="line">&#123; <span class="attr">name</span>: <span class="string">&#x27;Jane&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">groupBy</span>(<span class="params">objectArray, property</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> objectArray.<span class="title function_">reduce</span>( <span class="function">(<span class="params">acc, obj</span>)=&gt;</span> &#123;</span><br><span class="line"><span class="keyword">let</span> key = obj[property];</span><br><span class="line"><span class="keyword">if</span> (!acc[key]) &#123;</span><br><span class="line">acc[key] = [];</span><br><span class="line">&#125;</span><br><span class="line">acc[key].<span class="title function_">push</span>(obj);</span><br><span class="line"><span class="keyword">return</span> acc;</span><br><span class="line">&#125;, &#123;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> groupedPeople = <span class="title function_">groupBy</span>(people, <span class="string">&#x27;age&#x27;</span>);</span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">// 20: [</span></span><br><span class="line"><span class="comment">// &#123; name: &#x27;Max&#x27;, age: 20 &#125;,</span></span><br><span class="line"><span class="comment">// &#123; name: &#x27;Jane&#x27;, age: 20 &#125;</span></span><br><span class="line"><span class="comment">// ],</span></span><br><span class="line"><span class="comment">// 21: [&#123; name: &#x27;Alice&#x27;, age: 21 &#125;]</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-2"><div class="note simple"><p><mark class="hl-label green">打印测试</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span><span class="keyword">var</span>关键字</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &gt; 5 5 5 5 5 </span></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span><span class="keyword">let</span>形成局部作用域</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(i),i*<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &gt;0 1 2 3 4</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span><span class="built_in">setTimeout</span>第三个参数为传入参数</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">(<span class="params">j</span>)=&gt;</span><span class="variable language_">console</span>.<span class="title function_">log</span>(j),i*<span class="number">1000</span>,i)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// &gt;0 1 2 3 4</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-3"><div class="note simple"><p><mark class="hl-label green">语法</mark><br>JSON.stringify(value[, replacer [, space]])<br><mark class="hl-label blue">value</mark><br>将要序列化成 一个JSON 字符串的值。<br><mark class="hl-label blue">replacer可选</mark><br>可以为数组或函数<br>如果为数组：则只有包含在这个数组中的属性名才会被序列化到最终的 JSON 字符串中，replacer作key值（这个在讲实例的时候就知道这个key是干嘛的了，先记住就好）<br>如果为函数：则把系列化后的每一个对象（记住是每一个）传进方法里面进行处理<br><mark class="hl-label blue">space可选</mark><br>指定缩进用的空白字符串<br>如果省略的话，那么显示出来的值就没有分隔符。直接输出来<br>如果是一个数字的话，那么它就定义缩进几个字符，范围是：0到10（数字小于1，则默认为0，大于10，则默认为10）<br>如果是一些转义字符，比如“\t”，表示回车，那么它每行一个回车。<br>如果仅仅是字符串，就在每行输出值的时候把这些字符串附加上去就OK。当然，最大长度也是10个字符</p>
</div>
<div class="note simple"><p><mark class="hl-label green">实例</mark><br>第三个参数就是用来缩进或者直接添加字符串在序列化对象的前面，注意最多只能10个缩进或字符</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">a</span>: <span class="number">2</span> &#125;, <span class="literal">null</span>, <span class="string">&quot; &quot;</span>);   </span><br><span class="line"><span class="comment">// 输出结果：&#123;\n &quot;a&quot;: 2\n&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">uno</span>: <span class="number">1</span>, dos : <span class="number">2</span> &#125;, <span class="literal">null</span>, <span class="string">&#x27;\t&#x27;</span>)</span><br><span class="line"><span class="comment">/* 输出结果：</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">    &quot;uno&quot;: 1,</span></span><br><span class="line"><span class="comment">    &quot;dos&quot;: 2</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> students = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">students.<span class="property">name</span> = <span class="string">&quot;pika&quot;</span>;</span><br><span class="line">students.<span class="property">age</span> = <span class="number">19</span>;</span><br><span class="line">students.<span class="property">qq</span> = <span class="string">&quot;12345678&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> stu= <span class="keyword">new</span> <span class="title class_">Array</span>();</span><br><span class="line">stu[<span class="number">0</span>] = <span class="string">&quot;name&quot;</span>;</span><br><span class="line">stu[<span class="number">1</span>] = <span class="string">&quot;qq&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> json = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(students,stu,<span class="string">&quot;test&quot;</span>)</span><br><span class="line"><span class="title function_">alert</span>(json);</span><br><span class="line"><span class="comment">/* 输出结果：</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">test&quot;name&quot;: &quot;pika&quot;,</span></span><br><span class="line"><span class="comment">test&quot;qq&quot;: &quot;12345678&quot;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-4"><div class="note simple"><p><mark class="hl-label green">讲解1</mark><br><a href="https://www.zhangxinxu.com/wordpress/2020/10/es6-html-template-literal/">ES6模板字符串在HTML模板渲染中的应用</a></p>
</div>
<div class="note simple"><p><mark class="hl-label green">实现方法</mark><br>1.html文件</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">&quot;tableMix&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ui-table table&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">&quot;20&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>文章标题<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">&quot;22%&quot;</span>&gt;</span>发布时间<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span> <span class="attr">width</span>=<span class="string">&quot;15%&quot;</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span>评论数<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">$&#123;data.map(function (obj, index) &#123;</span><br><span class="line">  return `<span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;obj.id&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ell&quot;</span>&gt;</span>$&#123;obj.title&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>$&#123;obj.time&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span>$&#123;obj.comment&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span>`;</span><br><span class="line">&#125;).join(&#x27;&#x27;)&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
2.普通字符串转模板字符串
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// HTML字符反转义   &amp;lt;  =&gt;  &lt; </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">escape2Html</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> arrEntities = &#123; <span class="string">&#x27;lt&#x27;</span>: <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&#x27;gt&#x27;</span>: <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;nbsp&#x27;</span>: <span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;amp&#x27;</span>: <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;quot&#x27;</span>: <span class="string">&#x27;&quot;&#x27;</span> &#125;;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">replace</span>(<span class="regexp">/&amp;(lt|gt|nbsp|amp|quot);/ig</span>, <span class="keyword">function</span> (<span class="params">all, t</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> arrEntities[t];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert a string to a template-string</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">Object</span>&#125; params 模板数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">String</span>&#125;        模板字符串语法解析后的字符串</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">String</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">interpolate</span> = <span class="keyword">function</span> (<span class="params">params</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> names = <span class="title class_">Object</span>.<span class="title function_">keys</span>(params);</span><br><span class="line">    <span class="keyword">const</span> vals = <span class="title class_">Object</span>.<span class="title function_">values</span>(params);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Function</span>(...names, <span class="string">`return \`<span class="subst">$&#123;escape2Html(<span class="variable language_">this</span>)&#125;</span>\`;`</span>)(...vals);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>3.业务代码</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 业务处理代码</span></span><br><span class="line"><span class="keyword">var</span> eleTbody = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#tableMix tbody&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> strTemplate = eleTbody.<span class="title function_">querySelector</span>(<span class="string">&#x27;template&#x27;</span>).<span class="property">innerHTML</span>;</span><br><span class="line"><span class="comment">// 获取数据</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;./ajax-article-list.php&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> res.<span class="title function_">json</span>();    </span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">json</span> =&gt;</span> &#123;</span><br><span class="line">    eleTbody.<span class="property">innerHTML</span> = strTemplate.<span class="title function_">interpolate</span>(json.<span class="property">data</span>);    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
4.效果

<p><a href="https://imgtu.com/i/jx27oq"><img src="https://s1.ax1x.com/2022/07/26/jx27oq.png" alt="jx27oq.png" border="0" /></a></p>
<p>5.其中json数据结构如下：</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;msg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;获取成功&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0001&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;如何让文字作为CSS背景图片显示？&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2020年10月20日&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;comment&quot;</span><span class="punctuation">:</span> <span class="number">7</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0002&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SVG feTurbulence滤镜深入介绍&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2020年10月17日&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;comment&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0003&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HTML enterkeyhint设置iOS/Android键盘enter键&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2020年10月11日&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;comment&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0004&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;快速学习CSS Color Level 4的色值新语法&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2020年10月11日&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;comment&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span>    </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-5"><div class="note simple"><p><mark class="hl-label green">需要处理哪些异常？</mark><br>1、JavaScript 语法错误、代码异常<br>2、异步请求异常<br>3、静态资源加载异常<br>4、Promise 异常<br>5、跨域<br>6、崩溃与渲染异常</p>
</div>
<div class="note simple"><p><mark class="hl-label green">错误处理方式</mark><br>1、try-catch<br>2、window.onerror<br>3、window.addEventListener<br>4、Promise catch<br>5、vue errorHandler<br>6、 react 异常捕获<br>7、跨域</p>
</div>
<div class="note simple"><p><a href="https://blog.csdn.net/qq_41809113/article/details/125960882">详细处理解析</a> </p>
</div>
<div class="note simple"><p><mark class="hl-label green">react错误边界</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">// 用于标识子组件是否产生错误</span></span><br><span class="line">  state = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125; </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 只要这个错误边界组件包裹的后代组件发生错误，就会触发这个钩子，发生的错误信息会作为参数传入</span></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidCatch</span>(<span class="params">error, errorInfo</span>) &#123;</span><br><span class="line">    <span class="comment">// 可以将错误日志上报给服务器</span></span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="comment">// 可以自定义降级后的 UI 并渲染</span></span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>发生错误了...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 然后就可以当做一个常规组件去使用</span></span><br><span class="line">&lt;<span class="title class_">ErrorBoundary</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">MyWidget</span> /&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">ErrorBoundary</span>&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-6"><div class="note simple"><p><strong>AOP</strong> (面向切面编程) 的主要作用就是把一些和核心业务逻辑模块无关的功能抽取出来，然后再通过“动态织入”的方式掺到业务模块种。这些功能一般包括日志统计，安全控制，异常处理等。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">eat</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;吃饭&#x27;</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">brushTeeth</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;刷牙&#x27;</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">wipe</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;擦嘴&#x27;</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 前置函数</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">before</span> = <span class="keyword">function</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> self = <span class="variable language_">this</span>; <span class="comment">// 保留原函数的引用</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 返回包含了原函数和新函数的&quot;代理&quot;函数</span></span><br><span class="line">    <span class="comment">// 执行新函数，且保证 this 不被劫持，新函数接受的参数也会被原封不动地传入原函数，新函数在原函数之前执行</span></span><br><span class="line">    fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="comment">// 执行原函数并返回原函数的执行结果，并且保证 this 不被劫持</span></span><br><span class="line">    <span class="keyword">return</span> self.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 后置函数</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">after</span> = <span class="keyword">function</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> self = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> ret = self.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> app = eat.<span class="title function_">before</span>(brushTeeth).<span class="title function_">after</span>(wipe);</span><br><span class="line"><span class="title function_">app</span>(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="comment">// 刷牙 Arguments [&quot;test&quot;, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span></span><br><span class="line"><span class="comment">// 吃饭 Arguments [&quot;test&quot;, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span></span><br><span class="line"><span class="comment">// 擦嘴 Arguments [&quot;test&quot;, callee: ƒ, Symbol(Symbol.iterator): ƒ]</span></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-7"><div class="note simple"><p><mark class="hl-label green">防抖</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">简单实现</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, options</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; delay &#125; = options;</span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">  &#125;</span><br><span class="line">  timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    fn.<span class="title function_">call</span>(<span class="variable language_">this</span>, ...args);</span><br><span class="line">    timer = <span class="literal">null</span>;</span><br><span class="line">  &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// -----------立即执行防抖函数</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">debounce2</span>(<span class="params">fn, delay</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> timer</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span></span><br><span class="line">        <span class="keyword">if</span> (timer) <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> callNow = !timer</span><br><span class="line">        timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          timer = <span class="literal">null</span></span><br><span class="line">        &#125;, delay);</span><br><span class="line">        <span class="keyword">if</span> (callNow) &#123; <span class="title function_">fn</span>(args) &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ----------立即执行防抖函数+普通防抖</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">debounce3</span>(<span class="params">fn, delay, immediate</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> timer</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span></span><br><span class="line">        <span class="keyword">let</span> _this = <span class="variable language_">this</span></span><br><span class="line">        <span class="keyword">if</span> (timer) <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">          <span class="keyword">let</span> callNow = !timer</span><br><span class="line">          timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            timer = <span class="literal">null</span></span><br><span class="line">          &#125;, delay);</span><br><span class="line"></span><br><span class="line">          <span class="keyword">if</span> (callNow) &#123; fn.<span class="title function_">apply</span>(_this, args) &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          timeout = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            func.<span class="title function_">apply</span>(_this, <span class="variable language_">arguments</span>)</span><br><span class="line">          &#125;, delay);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">节流</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ---------------------------------------------------------节流 ，时间戳版</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn, wait</span>) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> previous = <span class="number">0</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> now = <span class="title class_">Date</span>.<span class="title function_">now</span>()</span><br><span class="line">        <span class="keyword">let</span> _this = <span class="variable language_">this</span></span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span></span><br><span class="line">        <span class="keyword">if</span> (now - previous &gt; wait) &#123;</span><br><span class="line">          fn.<span class="title function_">apply</span>(_this, <span class="variable language_">arguments</span>)</span><br><span class="line">          previous = now</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ---------------------------------------------------------节流 ，定时器版</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">throttle2</span>(<span class="params">fn, wait</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> timer</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> _this = <span class="variable language_">this</span></span><br><span class="line">        <span class="keyword">let</span> args = <span class="variable language_">arguments</span></span><br><span class="line">        <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">          timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            timer = <span class="literal">null</span></span><br><span class="line">            fn.<span class="title function_">apply</span>(_this, <span class="variable language_">arguments</span>)</span><br><span class="line">          &#125;, wait);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-8"><div class="note simple"><p><mark class="hl-label green">柯里化</mark><br>给函数分步传递参数，每次传递部分参数，并返回一个更具体的函数接收剩下的参数，这中间可嵌套多层这样的接收部分参数的函数，直至返回最后结果。</p>
<p>作用：1、缓存参数；2、包装功能函数</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">简单实现</span><br><span class="line"><span class="comment">// ES6 的实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">currying</span>(<span class="params">func, args = []</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> arity = func.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">..._args</span>) &#123;</span><br><span class="line">    _args.<span class="title function_">unshift</span>(...args);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (_args.<span class="property">length</span> &lt; arity) &#123;</span><br><span class="line">      <span class="keyword">return</span> currying.<span class="title function_">call</span>(<span class="literal">null</span>, func, _args);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">func</span>(..._args);</span><br><span class="line">    j;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 被转换函数，用于检测传入的字符串是否符合正则表达式</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkFun</span>(<span class="params">reg, str</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> reg.<span class="title function_">test</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 转换柯里化</span></span><br><span class="line"><span class="keyword">let</span> check = <span class="title function_">currying</span>(checkFun);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 产生新的功能函数</span></span><br><span class="line"><span class="keyword">let</span> checkPhone = <span class="title function_">check</span>(<span class="regexp">/^1[34578]\d&#123;9&#125;$/</span>);</span><br><span class="line"><span class="keyword">let</span> checkEmail = <span class="title function_">check</span>(<span class="regexp">/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">bind</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span>(<span class="params">context, ...args</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="function">(<span class="params">...newArgs</span>) =&gt;</span> <span class="variable language_">this</span>.<span class="title function_">apply</span>(context, args.<span class="title function_">concat</span>(newArgs));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">反柯里化</mark><br>作用：将私有方法公有化</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">简单实现</span><br><span class="line"><span class="comment">// ES6 的实现</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uncurring</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">call</span>(...args);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用反柯里化创建检测数据类型的函数</span></span><br><span class="line"><span class="keyword">let</span> checkType = <span class="title function_">uncurring</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">checkType</span>(<span class="number">1</span>); <span class="comment">// [object Number]</span></span><br><span class="line"><span class="title function_">checkType</span>(<span class="string">&#x27;hello&#x27;</span>); <span class="comment">// [object String]</span></span><br><span class="line"><span class="title function_">checkType</span>(<span class="literal">true</span>); <span class="comment">// [object Boolean]</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">通过函数调用生成反柯里化函数</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">uncurring</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> self = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">call</span>.<span class="title function_">apply</span>(self, <span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">F</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">F.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;I&#x27;m &quot;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&#x27;, &#x27;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&#x27; years old.&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 希望 sayHi 方法被任何对象使用</span></span><br><span class="line">sayHi = F.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHi</span>.<span class="title function_">uncurring</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_">sayHi</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;Panda&#x27;</span>, <span class="attr">age</span>: <span class="number">20</span> &#125;); <span class="comment">// &gt; I&#x27;m Panda, 20 years old.</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-9"><div class="note simple"><p> <mark class="hl-label red">new</mark><br>1.创建（或者说构造）一个全新的对象。<br>2.这个新对象会被执行 [[ 原型 ]] 连接。<br>3.这个新对象会绑定到函数调用的 this。<br>4.如果函数没有返回其他对象，那么 new 表达式中的函数调用会自动返回这个新对象。<br> <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">function</span> <span class="title function_">myNew</span>(<span class="params">fn, ...rest</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(fn.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">  <span class="keyword">const</span> temp = fn.<span class="title function_">call</span>(obj, ...rest);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> temp <span class="keyword">instanceof</span> <span class="title class_">Object</span> ? temp : obj;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>
 </p>
</div>
 
<div class="note simple"><p><mark class="hl-label green">原型继承</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 原型继承</span></span><br><span class="line"><span class="comment">// 把父类的实例作为子类的原型</span></span><br><span class="line"><span class="comment">// 缺点：子类的实例共享了父类构造函数的引用属性 不能传参</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> person = &#123;</span><br><span class="line">      <span class="attr">friends</span>: [<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> p1 = <span class="title class_">Object</span>.<span class="title function_">create</span>(person)</span><br><span class="line"></span><br><span class="line">    p1.<span class="property">friends</span>.<span class="title function_">push</span>(<span class="string">&quot;aaa&quot;</span>)<span class="comment">//缺点：子类的实例共享了父类构造函数的引用属性</span></span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(p1);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(person);<span class="comment">//缺点：子类的实例共享了父类构造函数的引用属性</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
<div class="note simple"><p><mark class="hl-label green">组合继承</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 在子函数中运行父函数，但是要利用 call 把 this 改变一下，</span></span><br><span class="line"><span class="comment">// 再在子函数的 prototype 里面 new Father() ,使 Father 的原型中的方法也得到继承，最后改变 Son 的原型中的 constructor</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 缺点：调用了两次父类的构造函数，造成了不必要的消耗，父类方法可以复用</span></span><br><span class="line"><span class="comment">// 优点可传参，不共享父类引用属性</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params">name</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hobby</span> = [<span class="string">&quot;篮球&quot;</span>, <span class="string">&quot;足球&quot;</span>, <span class="string">&quot;乒乓球&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">      <span class="title class_">Father</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Father</span>()</span><br><span class="line">    <span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Son</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> s = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="string">&quot;ming&quot;</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(s);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">寄生组合继承</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//所谓寄生组合式继承，即通过借用构造函数来继承属性，通过原型链的混成形式来继承方法。</span></span><br><span class="line"><span class="comment">//其背后的基本思路是：不必为了指定子类型的原型而调用超类型的构造函数，我们所需要的无非就是超类型原型的一个副本而已。</span></span><br><span class="line"><span class="comment">//本质上，就是使用寄生式继承来继承超类型的原型，然后再将结果指定给子类型的原型。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//寄生组合式继承应该是目前最稳定的继承模式</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">function</span> <span class="title function_">Father</span>(<span class="params">name</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">hobby</span> = [<span class="string">&quot;篮球&quot;</span>, <span class="string">&quot;足球&quot;</span>, <span class="string">&quot;乒乓球&quot;</span>]</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">Son</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">      <span class="title class_">Father</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name)</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Father</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line">    <span class="title class_">Son</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Son</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span> s2 = <span class="keyword">new</span> <span class="title class_">Son</span>(<span class="string">&quot;ming&quot;</span>, <span class="number">18</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(s2);</span><br></pre></td></tr></table></figure></div>
<div class="note simple"><p><mark class="hl-label green">class-extends继承</mark> </p>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-10"><div class="note simple"><p><mark class="hl-label green">copy原理</mark><br>js中，对于赋值操作符:&#x3D;<br>基本类型的数据：number，string，boolean等的赋值copy直接是深拷贝<br>对于引用类型的数据:array，object等的赋值copy是copy第一层的引用地址，操作对象始终是原对象</p>
</div>
<div class="note simple"><p><mark class="hl-label green">浅拷贝</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a=<span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="comment">//浅拷贝</span></span><br><span class="line"><span class="keyword">let</span> b=a</span><br><span class="line"><span class="keyword">let</span> arr2=[...arr]</span><br></pre></td></tr></table></figure></div><div class="note simple"><p><mark class="hl-label green">深拷贝</mark><br>注意<br>1.数据类型校验<br>2.循环引用</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">deepClone</span>(<span class="params">data, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (data == <span class="literal">undefined</span>) <span class="keyword">return</span> data;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> data !== <span class="string">&#x27;object&#x27;</span>) <span class="keyword">return</span> data;</span><br><span class="line">  <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="title class_">RegExp</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RegExp</span>(data);</span><br><span class="line">  <span class="keyword">if</span> (data <span class="keyword">instanceof</span> <span class="title class_">Date</span>) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(data);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> v = hash.<span class="title function_">get</span>(data);</span><br><span class="line">  <span class="keyword">if</span> (v) <span class="keyword">return</span> v;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> instance = <span class="keyword">new</span> data.<span class="title function_">constructor</span>(<span class="params"></span>);</span><br><span class="line">  hash.<span class="title function_">set</span>(data, instance);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data.<span class="title function_">hasOwnProperty</span>(key)) &#123;</span><br><span class="line">      instance[key] = <span class="title function_">deepClone</span>(data[key], hash);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;bob&#x27;</span>,</span><br><span class="line">  <span class="attr">desc</span>: &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="number">12</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="title function_">deepClone</span>(a);</span><br><span class="line">b.<span class="property">desc</span>.<span class="property">age</span> = <span class="number">100</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"></span><br><span class="line"><span class="comment">// js循环引用</span></span><br><span class="line"><span class="keyword">var</span> t = &#123;&#125;;</span><br><span class="line">t.<span class="property">t</span> = t;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">deepClone</span>(t));</span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<div class="note success simple"><h2 id="思想进阶"><a href="#思想进阶" class="headerlink" title="思想进阶"></a>思想进阶</h2></div>
<div class="tabs" id="first"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#first-1">设计模式</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="first-1"><p><a href="https://imgtu.com/i/jvPCBd"><img src="https://s1.ax1x.com/2022/07/25/jvPCBd.png" alt="jvPCBd.png" border="0" /></a><br><a href="https://hefeng6500.github.io/blog/design-patterns">设计模式引用讲解</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>

<div class="note success simple"><h2 id="应用进阶"><a href="#应用进阶" class="headerlink" title="应用进阶"></a>应用进阶</h2></div>
<div class="tabs" id="first"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#first-1">dom应用</button></li><li class="tab"><button type="button" data-href="#first-2">懒加载</button></li><li class="tab"><button type="button" data-href="#first-3">上传与下载</button></li><li class="tab"><button type="button" data-href="#first-4">nodejs相关</button></li><li class="tab"><button type="button" data-href="#first-5">性能优化</button></li><li class="tab"><button type="button" data-href="#first-6">React</button></li><li class="tab"><button type="button" data-href="#first-7">rem适配</button></li><li class="tab"><button type="button" data-href="#first-8">webworker</button></li><li class="tab"><button type="button" data-href="#first-9">requestAnimationFrame</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="first-1"><div class="note simple"><p><mark class="hl-label green">包装简易jquery</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">jQuery</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">selector</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> slice = <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>;</span><br><span class="line">    <span class="keyword">let</span> dom = slice.<span class="title function_">call</span>(<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(selector));</span><br><span class="line">    <span class="keyword">let</span> len = dom ? dom.<span class="property">length</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">      <span class="variable language_">this</span>[i] = dom[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">length</span> = len;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">selector</span> = selector || <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">append</span>(<span class="params">node</span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">addClass</span>(<span class="params">name</span>) &#123;&#125;</span><br><span class="line">  <span class="title function_">html</span>(<span class="params">data</span>) &#123;&#125;</span><br><span class="line">  <span class="comment">// 此处省略若干 API</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">$</span> = <span class="keyword">function</span>(<span class="params">selector</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">jQuery</span>(selector);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<div class="note simple"><p><mark class="hl-label green">利用代理包装简易dom操作语言</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> dom = <span class="keyword">new</span> <span class="title class_">Proxy</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, property</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">attrs = &#123;&#125;, ...children</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> el = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(property);</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> prop <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(attrs)) &#123;</span><br><span class="line">        el.<span class="title function_">setAttribute</span>(prop, attrs[prop]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> child <span class="keyword">of</span> children) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> child === <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">          child = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(child);</span><br><span class="line">        &#125;</span><br><span class="line">        el.<span class="title function_">appendChild</span>(child);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> el;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> el = dom.<span class="title function_">div</span>(&#123;&#125;,</span><br><span class="line">  <span class="string">&#x27;Hello, my name is &#x27;</span>,</span><br><span class="line">  dom.<span class="title function_">a</span>(&#123;<span class="attr">href</span>: <span class="string">&#x27;//example.com&#x27;</span>&#125;, <span class="string">&#x27;Mark&#x27;</span>),</span><br><span class="line">  <span class="string">&#x27;. I like:&#x27;</span>,</span><br><span class="line">  dom.<span class="title function_">ul</span>(&#123;&#125;,</span><br><span class="line">    dom.<span class="title function_">li</span>(&#123;&#125;, <span class="string">&#x27;The web&#x27;</span>),</span><br><span class="line">    dom.<span class="title function_">li</span>(&#123;&#125;, <span class="string">&#x27;Food&#x27;</span>),</span><br><span class="line">    dom.<span class="title function_">li</span>(&#123;&#125;, <span class="string">&#x27;…actually that\&#x27;s it&#x27;</span>)</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(el);</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">Ajax</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Ajax</span> = &#123;</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params">url, callback</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> xhr = <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, url, <span class="literal">false</span>)</span><br><span class="line">        xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (xhr.<span class="property">status</span> == <span class="number">200</span> || xhr.<span class="property">status</span> == <span class="number">304</span>) &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">              <span class="title function_">callback</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.<span class="title function_">send</span>()</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="attr">post</span>: <span class="keyword">function</span> (<span class="params">url, data, callback</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">        <span class="comment">// 第三个参数为是否异步执行</span></span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&#x27;post&#x27;</span>, url, <span class="literal">true</span>)</span><br><span class="line">        <span class="comment">// 添加http头，设置编码类型</span></span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;x-www-form-urlencoded&quot;</span>)</span><br><span class="line">        xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.<span class="property">status</span> == <span class="number">200</span> || xhr.<span class="property">status</span> == <span class="number">304</span>) &#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">              <span class="title function_">callback</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-type&#x27;</span>, <span class="string">&quot;application/x-www-urlencoded&quot;</span>)</span><br><span class="line">        xhr.<span class="title function_">send</span>(data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-2"><div class="note simple"><p><mark class="hl-label green">图片懒加载</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">PreLoadImage</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">imgNode</span>) &#123;</span><br><span class="line">    <span class="comment">// 获取真实的DOM节点</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">imgNode</span> = imgNode;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 操作img节点的src属性</span></span><br><span class="line">  <span class="title function_">setSrc</span>(<span class="params">imgUrl</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">imgNode</span>.<span class="property">src</span> = imgUrl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProxyImage</span> &#123;</span><br><span class="line">  <span class="comment">// 占位图的url地址</span></span><br><span class="line">  <span class="keyword">static</span> <span class="variable constant_">LOADING_URL</span> = <span class="string">&quot;xxxxxx&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">targetImage</span>) &#123;</span><br><span class="line">    <span class="comment">// 目标Image，即PreLoadImage实例</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">targetImage</span> = targetImage;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 该方法主要操作虚拟Image，完成加载</span></span><br><span class="line">  <span class="title function_">setSrc</span>(<span class="params">targetUrl</span>) &#123;</span><br><span class="line">    <span class="comment">// 真实img节点初始化时展示的是一个占位图</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">targetImage</span>.<span class="title function_">setSrc</span>(<span class="title class_">ProxyImage</span>.<span class="property">LOADING_URL</span>);</span><br><span class="line">    <span class="comment">// 创建一个帮我们加载图片的虚拟Image实例</span></span><br><span class="line">    <span class="keyword">const</span> virtualImage = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">    <span class="comment">// 监听目标图片加载的情况，完成时再将DOM上的真实img节点的src属性设置为目标图片的url</span></span><br><span class="line">    virtualImage.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">targetImage</span>.<span class="title function_">setSrc</span>(targetUrl);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 设置src属性，虚拟Image实例开始加载图片</span></span><br><span class="line">    virtualImage.<span class="property">src</span> = targetUrl;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">原生dom</mark> </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Lazy-Load<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">200px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: gray;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.pic</span> &#123;</span></span><br><span class="line"><span class="language-css">        // 必要的<span class="selector-tag">img</span>样式</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        // 注意我们并没有为它引入真实的src</span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/1.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/2.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/3.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/4.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/5.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/6.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/7.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/8.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/9.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">class</span>=<span class="string">&quot;pic&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;加载中&quot;</span> <span class="attr">data-src</span>=<span class="string">&quot;./images/10.png&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取所有的图片标签</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> imgs = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;img&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取可视区域的高度</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> viewHeight = <span class="variable language_">window</span>.<span class="property">innerHeight</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// num用于统计当前显示到了哪一张图片，避免每次都从第一张图片开始检查是否露出</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> num = <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">lazyload</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">for</span>(<span class="keyword">let</span> i=num; i&lt;imgs.<span class="property">length</span>; i++) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 用可视区域高度减去元素顶部距离可视区域顶部的高度</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> distance = viewHeight - imgs[i].<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 如果可视区域高度大于等于元素顶部距离可视区域顶部的高度，说明元素露出</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(distance &gt;= <span class="number">0</span> )&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 给元素写入真实的src，展示图片</span></span></span><br><span class="line"><span class="language-javascript">                imgs[i].<span class="property">src</span> = imgs[i].<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-src&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 前i张图片已经加载完毕，下次从第i+1张开始检查是否露出</span></span></span><br><span class="line"><span class="language-javascript">                num = i + <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 监听Scroll事件</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, lazyload, <span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-3"><div class="note simple"><p><mark class="hl-label green">上传文件</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> file = <span class="keyword">new</span> <span class="title class_">File</span>([<span class="string">&quot;a&quot;</span>.<span class="title function_">repeat</span>(<span class="number">1000000</span>)], <span class="string">&quot;test.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> chunkSize = <span class="number">40000</span>;</span><br><span class="line"><span class="keyword">const</span> url = <span class="string">&quot;https://httpbin.org/post&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">chunkedUpload</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> start = <span class="number">0</span>; start &lt; file.<span class="property">size</span>; start += chunkSize) &#123;</span><br><span class="line">      <span class="keyword">const</span> chunk = file.<span class="title function_">slice</span>(start, start + chunkSize + <span class="number">1</span>);</span><br><span class="line">      <span class="keyword">const</span> fd = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">      fd.<span class="title function_">append</span>(<span class="string">&quot;data&quot;</span>, chunk);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">await</span> <span class="title function_">fetch</span>(url, &#123; <span class="attr">method</span>: <span class="string">&quot;post&quot;</span>, <span class="attr">body</span>: fd &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span></span><br><span class="line">        res.<span class="title function_">text</span>()</span><br><span class="line">      );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>



<div class="note simple"><p><mark class="hl-label green">利用a标签下载文件</mark><br>1.常规版</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">link.<span class="title function_">setAttribute</span>(<span class="string">&quot;download&quot;</span>, <span class="string">&quot;xxxxxx&quot;</span>) <span class="comment">//下载的文件名</span></span><br><span class="line">link.<span class="property">href</span> =url  <span class="comment">//文件url 路径必须是完整路径</span></span><br><span class="line">link.<span class="title function_">click</span>()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.blob精简版</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">download</span> = (<span class="params">fileName, blob</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> link = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">  link.<span class="property">href</span> = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(blob);</span><br><span class="line">  link.<span class="property">download</span> = fileName;</span><br><span class="line">  link.<span class="title function_">click</span>();</span><br><span class="line">  link.<span class="title function_">remove</span>();</span><br><span class="line">  <span class="variable constant_">URL</span>.<span class="title function_">revokeObjectURL</span>(link.<span class="property">href</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//下载按钮点击操作</span></span><br><span class="line"><span class="keyword">const</span> downloadBtn = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#downloadBtn&quot;</span>);</span><br><span class="line">downloadBtn.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> fileName = <span class="string">&quot;blob.txt&quot;</span>;</span><br><span class="line">  <span class="comment">//模拟的测试文件blob</span></span><br><span class="line">  <span class="keyword">const</span> myBlob = <span class="keyword">new</span> <span class="title class_">Blob</span>([<span class="string">&quot;一文彻底掌握 Blob Web API&quot;</span>], &#123; <span class="attr">type</span>: <span class="string">&quot;text/plain&quot;</span> &#125;);</span><br><span class="line">  <span class="title function_">download</span>(fileName, myBlob);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">从互联网上下载数据并将数据存储到Blob对象中</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span><span class="title class_">Ajax</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">downloadBlob</span> = (<span class="params">url, callback</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>()</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url)</span><br><span class="line">    xhr.<span class="property">responseType</span> = <span class="string">&#x27;blob&#x27;</span></span><br><span class="line">    xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>(xhr.<span class="property">response</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.<span class="title function_">send</span>(<span class="literal">null</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>fetch</span><br><span class="line"><span class="keyword">const</span> myImage = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> myRequest = <span class="keyword">new</span> <span class="title class_">Request</span>(<span class="string">&#x27;flowers.jpg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(myRequest)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">blob</span>();</span><br><span class="line">  &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">myBlob</span>) &#123;</span><br><span class="line">   <span class="keyword">let</span> objectURL = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(myBlob);</span><br><span class="line">   myImage.<span class="property">src</span> = objectURL;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>


<div class="note simple"><p><mark class="hl-label green">利用canvas压缩图片</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// compress.js</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">MAX_WIDTH</span> = <span class="number">800</span>; <span class="comment">// 图片最大宽度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">compress</span>(<span class="params">base64, quality, mimeType</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> canvas = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> img = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">  img.<span class="property">crossOrigin</span> = <span class="string">&quot;anonymous&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    img.<span class="property">src</span> = base64;</span><br><span class="line">    img.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> targetWidth, targetHeight;</span><br><span class="line">      <span class="keyword">if</span> (img.<span class="property">width</span> &gt; <span class="variable constant_">MAX_WIDTH</span>) &#123;</span><br><span class="line">        targetWidth = <span class="variable constant_">MAX_WIDTH</span>;</span><br><span class="line">        targetHeight = (img.<span class="property">height</span> * <span class="variable constant_">MAX_WIDTH</span>) / img.<span class="property">width</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        targetWidth = img.<span class="property">width</span>;</span><br><span class="line">        targetHeight = img.<span class="property">height</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      canvas.<span class="property">width</span> = targetWidth;</span><br><span class="line">      canvas.<span class="property">height</span> = targetHeight;</span><br><span class="line">      <span class="keyword">let</span> ctx = canvas.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">      ctx.<span class="title function_">clearRect</span>(<span class="number">0</span>, <span class="number">0</span>, targetWidth, targetHeight); <span class="comment">// 清除画布</span></span><br><span class="line">      ctx.<span class="title function_">drawImage</span>(img, <span class="number">0</span>, <span class="number">0</span>, canvas.<span class="property">width</span>, canvas.<span class="property">height</span>);</span><br><span class="line">      <span class="keyword">let</span> imageData = canvas.<span class="title function_">toDataURL</span>(mimeType, quality / <span class="number">100</span>);</span><br><span class="line">      <span class="title function_">resolve</span>(imageData);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>本地图片压缩<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;image/*&quot;</span> <span class="attr">onchange</span>=<span class="string">&quot;loadFile(event)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./compress.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> loadFile = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span><br><span class="line"><span class="language-javascript">        reader.<span class="property">onload</span> = <span class="keyword">async</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> compressedDataURL = <span class="keyword">await</span> <span class="title function_">compress</span>(</span></span><br><span class="line"><span class="language-javascript">            reader.<span class="property">result</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="number">90</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&quot;image/jpeg&quot;</span></span></span><br><span class="line"><span class="language-javascript">          );</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> compressedImageBlob = <span class="title function_">dataUrlToBlob</span>(compressedDataURL);</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">uploadFile</span>(<span class="string">&quot;https://httpbin.org/post&quot;</span>, compressedImageBlob);</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        reader.<span class="title function_">readAsDataURL</span>(event.<span class="property">target</span>.<span class="property">files</span>[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
</div>

<div class="note simple"><p><mark class="hl-label green">利用file转换成url显示</mark><br>1.Blob转换成Url</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> myImage = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> myRequest = <span class="keyword">new</span> <span class="title class_">Request</span>(<span class="string">&#x27;flowers.jpg&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fetch</span>(myRequest)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response.<span class="title function_">blob</span>();</span><br><span class="line">  &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">myBlob</span>) &#123;</span><br><span class="line">   <span class="keyword">let</span> objectURL = <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(myBlob);</span><br><span class="line">   myImage.<span class="property">src</span> = objectURL;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>2.FileReader API</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;file&quot;</span> accept=<span class="string">&quot;image/*&quot;</span> onchange=<span class="string">&quot;loadFile(event)&quot;</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span>/&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">const</span> loadFile = <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	reader.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		<span class="keyword">const</span> output = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		output.<span class="property">src</span> = reader.<span class="property">result</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	reader.<span class="title function_">readAsDataURL</span>(event.<span class="property">target</span>.<span class="property">files</span>[<span class="number">0</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">dataUrlToBlob</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dataUrlToBlob</span>(<span class="params">base64, mimeType</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> bytes = <span class="variable language_">window</span>.<span class="title function_">atob</span>(base64.<span class="title function_">split</span>(<span class="string">&quot;,&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">let</span> ab = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(bytes.<span class="property">length</span>);</span><br><span class="line">  <span class="keyword">let</span> ia = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(ab);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; bytes.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    ia[i] = bytes.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Blob</span>([ab], &#123; <span class="attr">type</span>: mimeType &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//压缩后的图片对应的 Blob 对象封装在 FormData 对象中，然后再通过 AJAX 提交到服务器上</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uploadFile</span>(<span class="params">url, blob</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span><br><span class="line">  <span class="keyword">let</span> request = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">  formData.<span class="title function_">append</span>(<span class="string">&quot;image&quot;</span>, blob);</span><br><span class="line">  request.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, url, <span class="literal">true</span>);</span><br><span class="line">  request.<span class="title function_">send</span>(formData);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">生成PDF文件</mark><br>1.图片</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> imgData = <span class="string">&#x27;data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/...&#x27;</span></span><br><span class="line"><span class="keyword">let</span> doc = <span class="keyword">new</span> <span class="title function_">jsPDF</span>();</span><br><span class="line"></span><br><span class="line">doc.<span class="title function_">setFontSize</span>(<span class="number">40</span>)</span><br><span class="line">doc.<span class="title function_">text</span>(<span class="number">35</span>, <span class="number">25</span>, <span class="string">&#x27;Paranyan loves jsPDF&#x27;</span>)</span><br><span class="line">doc.<span class="title function_">addImage</span>(imgData, <span class="string">&#x27;JPEG&#x27;</span>, <span class="number">15</span>, <span class="number">40</span>, <span class="number">180</span>, <span class="number">160</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2.文本</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>客户端生成 PDF 示例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>客户端生成 PDF 示例<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/jspdf@latest/dist/jspdf.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      (<span class="keyword">function</span> <span class="title function_">generatePdf</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> doc = <span class="keyword">new</span> <span class="title function_">jsPDF</span>();</span></span><br><span class="line"><span class="language-javascript">        doc.<span class="title function_">text</span>(<span class="string">&quot;Hello semlinker!&quot;</span>, <span class="number">66</span>, <span class="number">88</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> blob = <span class="keyword">new</span> <span class="title class_">Blob</span>([doc.<span class="title function_">output</span>()], &#123; <span class="attr">type</span>: <span class="string">&quot;application/pdf&quot;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">        blob.<span class="title function_">text</span>().<span class="title function_">then</span>(<span class="function">(<span class="params">blobAsText</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(blobAsText);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-4"><div class="note simple"><p><mark class="hl-label green">把图片对应的DataURLs数据提交到服务器处理保存</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)();</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/upload&#x27;</span>, <span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> imgData = req.<span class="property">body</span>.<span class="property">imgData</span>; <span class="comment">// 获取POST请求中的base64图片数据</span></span><br><span class="line">    <span class="keyword">let</span> base64Data = imgData.<span class="title function_">replace</span>(<span class="regexp">/^data:image\/\w+;base64,/</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> dataBuffer = <span class="title class_">Buffer</span>.<span class="title function_">from</span>(base64Data, <span class="string">&#x27;base64&#x27;</span>);</span><br><span class="line">    fs.<span class="title function_">writeFile</span>(<span class="string">&quot;image.png&quot;</span>, dataBuffer, <span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(err)&#123;</span><br><span class="line">          res.<span class="title function_">send</span>(err);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          res.<span class="title function_">send</span>(<span class="string">&quot;图片上传成功！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-5"><div class="note simple"><p><mark class="hl-label green">长列表渲染</mark><br><a href="https://hefeng6500.github.io/blog/performance">见链接</a></p>
</div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-6"><div class="note simple"><p><mark class="hl-label green">自定义useAxios-hook</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">useAxios</span>(<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [loading, setloading] = <span class="title function_">useState</span>(<span class="literal">false</span>)</span><br><span class="line">  <span class="keyword">const</span> [data, setdata] = <span class="title function_">useState</span>();</span><br><span class="line">  <span class="keyword">const</span> [err, seterr] = <span class="title function_">useState</span>()</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    axios</span><br><span class="line">      .<span class="title function_">get</span>(url)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setdata</span>(res)</span><br><span class="line">      &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">seterr</span>(err)</span><br><span class="line">      &#125;).<span class="title function_">finally</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="title function_">setloading</span>(<span class="literal">true</span>)</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,[url]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [loading,data,err];</span><br><span class="line">&#125;</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
  </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-7"><div class="note simple"><p><mark class="hl-label green">rem适配</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="comment">//rem适配</span></span><br><span class="line"> (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> styleEle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> docWidth = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span>;</span><br><span class="line">    <span class="keyword">const</span> rootFontSize = docWidth / <span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">    styleEle.<span class="property">innerHTML</span> = <span class="string">&#x27;html&#123;font-size:&#x27;</span> + rootFontSize + <span class="string">&#x27;px!important&#125;&#x27;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(styleEle);</span><br><span class="line"></span><br><span class="line">&#125;)()</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-8"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="first-9"><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>
]]></content>
      <categories>
        <category>ES6</category>
      </categories>
      <tags>
        <tag>ES6+</tag>
      </tags>
  </entry>
  <entry>
    <title>这是一个测试</title>
    <url>/hexo-blog/2022/07/24/test/</url>
    <content><![CDATA[<div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>



<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">alert</span>(<span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<div class="hide-block"><button type="button" class="hide-button" style="background-color: bg;color: color">display
    </button><div class="hide-content"><p>content </p>
</div></div>

<div class="note flat"><p>默认提示块标签</p>
</div>

<div class="note default flat"><p>default 提示块标签</p>
</div>

<div class="note primary flat"><p>primary 提示块标签</p>
</div>

<div class="note success flat"><p>success 提示块标签</p>
</div>

<div class="note info flat"><p>info 提示块标签</p>
</div>

<div class="note warning flat"><p>warning 提示块标签</p>
</div>

<div class="note danger flat"><p>danger 提示块标签</p>
</div>


<div class="tabs" id="test2"><ul class="nav-tabs"></ul><div class="tab-contents"></div></div>


<p>This is my website, click the button <a class="btn-beautify " href="https://butterfly.js.org/" 
  title="Butterfly"><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify " href="https://butterfly.js.org/" 
  title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://butterfly.js.org/" 
  title="Butterfly"><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify outline" href="https://butterfly.js.org/" 
  title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a><br>This is my website, click the button <a class="btn-beautify larger" href="https://butterfly.js.org/" 
  title="Butterfly"><i class="far fa-hand-point-right"></i><span>Butterfly</span></a></p>
<p>你看我长得漂亮不</p>
<p><img src="https://i.loli.net/2021/03/19/2P6ivUGsdaEXSFI.png"></p>
<p>我觉得很漂亮<img class="inline-img" src="https://i.loli.net/2021/03/19/5M4jUB3ynq7ePgw.png" style="height:150px"/></p>
<p>臣亮言：<mark class="hl-label default">先帝</mark> 创业未半，而<mark class="hl-label default">中道崩殂blue</mark> 。今天下三分，<mark class="hl-label default">益州疲敝pink</mark> ，此诚<mark class="hl-label default">危急存亡之秋red</mark> 也！然侍卫之臣，不懈于内；<mark class="hl-label default">忠志之士purple</mark> ，忘身于外者，盖追先帝之殊遇，欲报之于陛下也。诚宜开张圣听，以光先帝遗德，恢弘志士之气；不宜妄自菲薄，引喻失义，以塞忠谏之路也。<br>宫中、府中，俱为一体；陟罚臧否，不宜异同。若有<mark class="hl-label default">作奸orange</mark> 、<mark class="hl-label default">犯科green</mark> ，及为忠善者，宜付有司，论其刑赏，以昭陛下平明之治；不宜偏私，使内外异法也。</p>
<div class="timeline undefined"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>2022</p>
</div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>01-02</p>
</div></div><div class='timeline-item-content'><p>这是测试页面</p>
</div></div></div>]]></content>
      <categories>
        <category>Test</category>
      </categories>
  </entry>
  <entry>
    <title>面试问题</title>
    <url>/hexo-blog/2022/07/24/%E9%9D%A2%E8%AF%95/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">面试总集</mark> </p>
<p><a href="https://blog.csdn.net/qq_33277654/article/details/122924692">面试总集</a></p>
</div>
]]></content>
      <categories>
        <category>面试</category>
      </categories>
      <tags>
        <tag>面试</tag>
      </tags>
  </entry>
  <entry>
    <title>socketio</title>
    <url>/hexo-blog/2022/07/29/socket/</url>
    <content><![CDATA[<p><a href="https://github.com/foolishandi/chatrom">前后端分离</a></p>
<div class="note simple"><p><mark class="hl-label green">前后端分离</mark><br>1.客户端<br>1.1文件夹<br>client<br>   -axiosCarry.js<br>   -index.css<br>   -link.js<br>   -socket.io.min.js<br>   -index.html<br>1.2 socket部分的link.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> name=<span class="variable language_">window</span>.<span class="title function_">prompt</span>(<span class="string">&#x27;请输入您的姓名:&#x27;</span>,<span class="string">&#x27;小明&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> user=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">user.<span class="property">value</span>=name</span><br><span class="line">username=user.<span class="property">value</span>===<span class="string">&#x27;&#x27;</span>?<span class="string">&#x27;&#x27;</span>:<span class="string">`?username=<span class="subst">$&#123;user.value&#125;</span>`</span></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">`http://localhost:3000/api/login<span class="subst">$&#123;username&#125;</span>`</span>).<span class="title function_">then</span>(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(e.<span class="property">data</span>.<span class="property">token</span>)<span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;token&#x27;</span>,e.<span class="property">data</span>.<span class="property">token</span>)</span><br><span class="line">    <span class="title function_">socketStart</span>()</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">socketStart</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> socket = <span class="title function_">io</span>(<span class="string">`http://localhost:3000/`</span>, &#123;</span><br><span class="line">        <span class="comment">// withCredentials: true,</span></span><br><span class="line">        <span class="attr">extraHeaders</span>: &#123;</span><br><span class="line">            <span class="title class_">Auth</span>: <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;token&quot;</span>),</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> messages = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;messages&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> form = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;form&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input&quot;</span>);</span><br><span class="line"></span><br><span class="line">    form.<span class="title function_">addEventListener</span>(<span class="string">&quot;submit&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        e.<span class="title function_">preventDefault</span>();</span><br><span class="line">        <span class="keyword">if</span> (input.<span class="property">value</span>) &#123;</span><br><span class="line">            socket.<span class="title function_">emit</span>(<span class="string">&quot;chat message&quot;</span>, input.<span class="property">value</span>);</span><br><span class="line">            input.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    socket.<span class="title function_">on</span>(<span class="string">&quot;chat message&quot;</span>, <span class="keyword">function</span> (<span class="params">msg</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> item = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;li&quot;</span>);</span><br><span class="line">        item.<span class="property">textContent</span> = msg;</span><br><span class="line">        messages.<span class="title function_">appendChild</span>(item);</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollHeight</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.服务器端<br>2.1文件夹<br>server<br>    -api.js<br>    -jwt.js<br>    -server.js<br>    -socketio.js<br>2.2 api.js</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT</span> = <span class="built_in">require</span>(<span class="string">&#x27;./jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">testRouter</span>(<span class="params">app</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> socketType = &#123;</span><br><span class="line">        <span class="attr">error</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">grounplist</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">grounpChart</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">singerChart</span>: <span class="number">3</span></span><br><span class="line">      &#125;</span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">        res.<span class="title function_">send</span>(socketType)</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="comment">// 接口设置</span></span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/api/login&#x27;</span>, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> verifyData = <span class="title class_">Object</span>.<span class="title function_">keys</span>(req.<span class="property">body</span>).<span class="property">length</span> ? req.<span class="property">body</span> : req.<span class="property">query</span></span><br><span class="line">        <span class="comment">// console.log(&#x27;a&#x27;,verifyData);</span></span><br><span class="line">        <span class="keyword">if</span> (verifyData.<span class="property">username</span>) &#123;</span><br><span class="line">          <span class="comment">// 设置token时间</span></span><br><span class="line">          <span class="keyword">const</span> newToken = <span class="variable constant_">JWT</span>.<span class="title function_">generate</span>(&#123;</span><br><span class="line">            <span class="comment">// _id: payload._id,</span></span><br><span class="line">            <span class="attr">username</span>: verifyData.<span class="property">username</span></span><br><span class="line">          &#125;, <span class="string">&#x27;1d&#x27;</span>)</span><br><span class="line">          res.<span class="title function_">header</span>(<span class="string">&#x27;Auth&#x27;</span>, newToken)</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(newToken)</span><br><span class="line">          res.<span class="title function_">send</span>(&#123;socketType,<span class="attr">token</span>:newToken,<span class="attr">username</span>:verifyData.<span class="property">username</span>&#125;)</span><br><span class="line">          <span class="title function_">next</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(&#123;</span><br><span class="line">            <span class="attr">errorCode</span>: -<span class="number">1</span>,</span><br><span class="line">            <span class="attr">tokenInfor</span>: <span class="string">&quot;请带上username字段访问&quot;</span></span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">route</span>=testRouter</span><br><span class="line">  </span><br></pre></td></tr></table></figure>
2.3 server.js
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>).<span class="title class_">Server</span>(app);</span><br><span class="line"><span class="keyword">const</span> port = process.<span class="property">env</span>.<span class="property">PORT</span> || <span class="number">3000</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT</span> = <span class="built_in">require</span>(<span class="string">&#x27;./jwt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// socket</span></span><br><span class="line"><span class="keyword">const</span> socket = <span class="built_in">require</span>(<span class="string">&#x27;./socketio&#x27;</span>)</span><br><span class="line"><span class="comment">// 共享express端口服务http</span></span><br><span class="line">socket.<span class="title function_">start</span>(http)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//express设置</span></span><br><span class="line"><span class="comment">// 解析get、post数据</span></span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line">  <span class="attr">extended</span>: <span class="literal">false</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">//express跨域设置</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">  res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;Content-Type,Content-Length,Auth,Accept,X-Requested-With&#x27;</span>);</span><br><span class="line">  res.<span class="title function_">header</span>(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;PUT,POST,GET,DELETE,OPTIONS&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&#x27;OPTIONS&#x27;</span>) &#123;</span><br><span class="line">    res.<span class="title function_">send</span>(<span class="number">200</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//token鉴权</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">url</span>.<span class="title function_">includes</span>(<span class="string">&#x27;login&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> token = req.<span class="property">headers</span>[<span class="string">&quot;auth&quot;</span>]?.<span class="title function_">split</span>(<span class="string">&#x27; &#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">if</span> (token) &#123;</span><br><span class="line">    <span class="keyword">const</span> payload = <span class="variable constant_">JWT</span>.<span class="title function_">verify</span>(token)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(payload)</span><br><span class="line">    <span class="keyword">if</span> (payload) &#123;</span><br><span class="line">      <span class="comment">// 重新计算token时间</span></span><br><span class="line">      <span class="keyword">const</span> newToken = <span class="variable constant_">JWT</span>.<span class="title function_">generate</span>(&#123;</span><br><span class="line">        <span class="comment">// _id: payload._id,</span></span><br><span class="line">        <span class="attr">username</span>: payload.<span class="property">username</span></span><br><span class="line">      &#125;, <span class="string">&#x27;1d&#x27;</span>)</span><br><span class="line">      res.<span class="title function_">header</span>(<span class="string">&#x27;Auth&#x27;</span>, newToken)</span><br><span class="line">      <span class="title function_">next</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">401</span>).<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">errorCode</span>: -<span class="number">1</span>,</span><br><span class="line">      <span class="attr">tokenInfor</span>: <span class="string">&quot;token过期&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">http.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Socket.IO server running at http://localhost:<span class="subst">$&#123;port&#125;</span>/`</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入测试api</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&#x27;./api&#x27;</span>)</span><br><span class="line">router.<span class="title function_">route</span>(app)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
2.4 socketio.js
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT</span> = <span class="built_in">require</span>(<span class="string">&#x27;./jwt&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">Server</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;socket.io&#x27;</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">socketInit</span>(<span class="params">http</span>) &#123;</span><br><span class="line">    <span class="comment">//socketio跨域设置</span></span><br><span class="line">    <span class="keyword">const</span> io = <span class="keyword">new</span> <span class="title class_">Server</span>(http, &#123;</span><br><span class="line">        <span class="attr">cors</span>: &#123;</span><br><span class="line">            <span class="attr">origin</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">            <span class="attr">allowedHeaders</span>: [<span class="string">&quot;Auth&quot;</span>],</span><br><span class="line">            <span class="attr">credentials</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> socketType = &#123;</span><br><span class="line">        <span class="attr">error</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">grounplist</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">grounpChart</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">singerChart</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">createMessage</span>(<span class="params">user, data</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (&#123;</span><br><span class="line">            user,</span><br><span class="line">            data</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//socketio链接</span></span><br><span class="line">    io.<span class="title function_">on</span>(<span class="string">&#x27;connection&#x27;</span>, <span class="function">(<span class="params">socket</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 获取token验证</span></span><br><span class="line">        <span class="keyword">const</span> token = (socket.<span class="property">handshake</span>.<span class="property">headers</span>.<span class="property">auth</span>)</span><br><span class="line">        <span class="keyword">const</span> payload = <span class="variable constant_">JWT</span>.<span class="title function_">verify</span>(token)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(payload)</span><br><span class="line">        <span class="keyword">if</span> (payload) &#123;</span><br><span class="line">            socket.<span class="title function_">on</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">                io.<span class="title function_">emit</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="string">`<span class="subst">$&#123;payload.username&#125;</span>: <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="comment">// sendAll(io)</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            socket.<span class="title function_">on</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> &#123;</span><br><span class="line">                io.<span class="title function_">emit</span>(<span class="string">&#x27;chat message&#x27;</span>, <span class="string">&#x27;token过期&#x27;</span>);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">start</span> = socketInit</span><br></pre></td></tr></table></figure>

<p>2.5 jwt</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入jwt-token鉴权</span></span><br><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> secret=<span class="string">&#x27;0123456789&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT</span>=&#123;</span><br><span class="line">    <span class="title function_">generate</span>(<span class="params">value,expires</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> jwt.<span class="title function_">sign</span>(value,secret,&#123;<span class="attr">expiresIn</span>:expires&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">verify</span>(<span class="params">token</span>)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> jwt.<span class="title function_">verify</span>(token,secret)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="variable constant_">JWT</span></span><br></pre></td></tr></table></figure>
</div>
]]></content>
      <categories>
        <category>socketio</category>
      </categories>
  </entry>
  <entry>
    <title>intl使用</title>
    <url>/hexo-blog/2022/07/29/intl/</url>
    <content><![CDATA[<div class="note default flat"><p><mark class="hl-label default">中文排序</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arrUsername = [<span class="string">&quot;陈坤&quot;</span>, <span class="string">&quot;邓超&quot;</span>, <span class="string">&quot;杜淳&quot;</span>, <span class="string">&quot;冯绍峰&quot;</span>, <span class="string">&quot;韩庚&quot;</span>, <span class="string">&quot;胡歌&quot;</span>, <span class="string">&quot;黄晓明&quot;</span>, <span class="string">&quot;贾乃亮&quot;</span>, <span class="string">&quot;李晨&quot;</span>, <span class="string">&quot;李易峰&quot;</span>, <span class="string">&quot;鹿晗&quot;</span>, <span class="string">&quot;井柏然&quot;</span>, <span class="string">&quot;刘烨&quot;</span>, <span class="string">&quot;陆毅&quot;</span>, <span class="string">&quot;孙红雷&quot;</span>];</span><br><span class="line"></span><br><span class="line">arrUsername.<span class="title function_">sort</span>(<span class="keyword">new</span> <span class="title class_">Intl</span>.<span class="title class_">Collator</span>(<span class="string">&#x27;zh&#x27;</span>).<span class="property">compare</span>);</span><br><span class="line"><span class="comment">// 结果是：[&quot;陈坤&quot;, &quot;邓超&quot;, &quot;杜淳&quot;, &quot;冯绍峰&quot;, &quot;韩庚&quot;, &quot;胡歌&quot;, &quot;黄晓明&quot;, &quot;贾乃亮&quot;, &quot;井柏然&quot;, &quot;李晨&quot;, &quot;李易峰&quot;, &quot;刘烨&quot;, &quot;陆毅&quot;, &quot;鹿晗&quot;, &quot;孙红雷&quot;]</span></span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure></div>

<div class="note default flat"><p><mark class="hl-label default">数字3位分组</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Intl</span>.<span class="title class_">NumberFormat</span>(<span class="literal">undefined</span>, &#123;</span><br><span class="line">    <span class="attr">minimumFractionDigits</span>: <span class="number">4</span></span><br><span class="line">&#125;).<span class="title function_">format</span>(<span class="number">12345.6789</span>);</span><br><span class="line"><span class="comment">// 结果是：&quot;12,345.6789&quot;</span></span><br></pre></td></tr></table></figure></div>]]></content>
      <categories>
        <category>intl</category>
      </categories>
      <tags>
        <tag>intl</tag>
      </tags>
  </entry>
  <entry>
    <title>babel</title>
    <url>/hexo-blog/2022/05/07/babel/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">babel常规安装</mark> </p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line">npm i @babel/core @babel/plugin-proposal-decorators @babel/preset-env</span><br><span class="line"></span><br><span class="line">npm i -D babel-loader @babel/core @babel/preset-env @babel/preset-react webpack</span><br><span class="line"></span><br><span class="line">&quot;@babel/core&quot;: ,</span><br><span class="line">&quot;@babel/cli&quot;: ,</span><br><span class="line">&quot;@babel/plugin-proposal-class-properties&quot;: ,</span><br><span class="line">&quot;@babel/plugin-proposal-decorators&quot;: ,</span><br><span class="line">&quot;@babel/preset-env&quot;:,</span><br></pre></td></tr></table></figure></div>
<div class="note simple"><p><mark class="hl-label green">.babelrc</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;presets&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;@babel/preset-env&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;plugins&quot;</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&quot;@babel/plugin-proposal-decorators&quot;</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">&quot;legacy&quot;</span>: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">&quot;@babel/plugin-proposal-class-properties&quot;</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

]]></content>
      <tags>
        <tag>babel</tag>
      </tags>
  </entry>
  <entry>
    <title>git</title>
    <url>/hexo-blog/2022/08/07/git/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">常用git配置</mark> </p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git branch -M main</span><br><span class="line">git commit -m &quot;first commit&quot;   --git commit --no-verify -m &quot;add goods&quot;</span><br><span class="line">git pull 				--git pull origin main --allow-unrelated-histories </span><br><span class="line">git push -u origin main     --  git push -f origin main</span><br><span class="line"></span><br><span class="line">git remote add origin 地址</span><br></pre></td></tr></table></figure></div>
]]></content>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo</title>
    <url>/hexo-blog/2022/03/07/hexo/</url>
    <content><![CDATA[<div class="note simple"><p><a href="https://blog.csdn.net/binglumeng/article/details/67637368">详细配置</a></p>
</div>

<div class="note simple"><p><mark class="hl-label green">hexo常用指令</mark> </p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line">1.生成相关</span><br><span class="line">npx hexo g //生成</span><br><span class="line">npx hexo d //发布到github</span><br><span class="line">npx hexo s //本地服务器生成</span><br><span class="line"></span><br><span class="line">2.文档相关</span><br><span class="line">npx hexo new post file //新建主页文档</span><br></pre></td></tr></table></figure>

<p><mark class="hl-label green">md语法</mark><br><a href="https://blog.csdn.net/qq_35427589/article/details/125119688?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165988107916781647587886%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=165988107916781647587886&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~times_rank-4-125119688-null-null.nonecase&utm_term=md%E6%96%87%E6%A1%A3%E8%AF%AD%E6%B3%95&spm=1018.2226.3001.4450">md语法</a></p>
</div>
]]></content>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>nginx</title>
    <url>/hexo-blog/2022/08/07/nginx/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">nginx常规配置</mark><br>路径 &#x2F;etc&#x2F;nginx&#x2F;sites-available&#x2F;default</p>
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">//默认访问端口</span><br><span class="line">server &#123;</span><br><span class="line">listen 80 ;</span><br><span class="line">listen [::]:80 ;</span><br><span class="line"></span><br><span class="line">    root /var/www/shop/dist;</span><br><span class="line"></span><br><span class="line">    index index.html index.htm index.nginx-debian.html;</span><br><span class="line"></span><br><span class="line">    server_name _;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">    	try_files $uri $uri/ /index;</span><br><span class="line">    &#125;</span><br><span class="line">    location ^~/api/ &#123;</span><br><span class="line">    	proxy_pass https://api.shop.eduwork.cn;  # 后端接口地址</span><br><span class="line">    	add_header &#x27;Access-Control-Allow-Origin&#x27; &#x27;*&#x27;; # 跨域</span><br><span class="line">    	# rewrite ^/api/(.*)$ /$1 break; # 删除配置规则</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 虚拟机</span><br><span class="line">server &#123;</span><br><span class="line">    listen 8001;</span><br><span class="line">    listen [::]:8001;</span><br><span class="line">    root /var/www/host1; # 访问路径，根目录下</span><br><span class="line">    index index.html;</span><br><span class="line">    location / &#123;</span><br><span class="line">        try_files $uri $uri/ /index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<mark class="hl-label green">ssl设置</mark> 
<figure class="highlight txt"><table><tr><td class="code"><pre><span class="line">listen 443 ssl default_server;</span><br><span class="line">ssl_certificate /etc/nginx/ssl/full_chain.pem;</span><br><span class="line">ssl_certificate_key /etc/nginx/ssl/private.key;</span><br><span class="line">ssl_session_timeout 5m;</span><br><span class="line">ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; #表示使用的加密套件的类型。</span><br><span class="line">ssl_protocols TLSv1.1 TLSv1.2 TLSv1.3; #表示使用的 TLS 协议的类型。</span><br><span class="line">ssl_prefer_server_ciphers on;</span><br></pre></td></tr></table></figure>
</div>
]]></content>
      <tags>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>vscode</title>
    <url>/hexo-blog/2022/08/07/vscode/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">常用插件</mark><br>1.<strong>驼峰翻译助手</strong> &#x2F;&#x2F;类名转化<br>2.<strong>Auto Rename Tag</strong> &#x2F;&#x2F;自动补全标签&lt;&gt;&lt;&#x2F;&gt;<br>3.<strong>Blockman</strong> &#x2F;&#x2F;作用域块<br>4.<strong>Brackst Select</strong> &#x2F;&#x2F;标记成对{},()…<br>5.<strong>CodeMetrics</strong> &#x2F;&#x2F;计算js复杂度<br>6.<strong>Color Hightlight</strong> &#x2F;&#x2F;颜色突出显示，如rgba，#123231，whitesmoke…<br>7.<strong>Color Info</strong> &#x2F;&#x2F;颜色信息<br>8.<strong>Color Picker</strong> &#x2F;&#x2F;可选择颜色<br>9.<strong>ESLint</strong> &#x2F;&#x2F;样式规范<br>10.<strong>import Cost</strong> &#x2F;&#x2F;导入大小计算<br>11.<strong>liver server</strong> &#x2F;&#x2F;本地html服务器</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;liveSassCompile.settings.generateMap&quot;: false,</span><br><span class="line">&quot;liveSassCompile.settings.autoprefix&quot;: [&quot;&gt; 1%&quot;, &quot;last 2 versions&quot;],</span><br><span class="line">&quot;liveSassCompile.settings.excludeList&quot;: [&quot;**/node_modules/**&quot;, &quot;.vscode/**&quot;],</span><br><span class="line">&quot;liveSassCompile.settings.formats&quot;: [</span><br><span class="line">  &#123;</span><br><span class="line">    &quot;format&quot;: &quot;expanded&quot;, //compressed</span><br><span class="line">    &quot;extensionName&quot;: &quot;.css&quot;,</span><br><span class="line">    &quot;savePath&quot;: &quot;~/css/&quot;</span><br><span class="line">  &#125;</span><br><span class="line">  // &#123;</span><br><span class="line">  //   &quot;format&quot;: &quot;compressed&quot;,//compressed</span><br><span class="line">  //   &quot;extensionName&quot;: &quot;.min.css&quot;,</span><br><span class="line">  //   &quot;savePath&quot;: &quot;~/css/&quot;</span><br><span class="line">  // &#125;</span><br><span class="line">],</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>12.<strong>path intellisense</strong> &#x2F;&#x2F;路径提示显示</p>
<p>13.<strong>rainbow bracket</strong> &#x2F;&#x2F;彩虹括号{},()。。。</p>
<p>14.<strong>settings sync</strong> &#x2F;&#x2F;vscode配置同步，需要github的Access_token</p>
<p>15.<strong>TODO Highlight</strong> &#x2F;&#x2F;TODO标志</p>
<p>16.<strong>Todo Tree</strong>&#x2F;&#x2F;TODO树</p>
<p>17.<strong>vscode-icons</strong> &#x2F;&#x2F;vs文件夹,文件类型图标显示</p>
<p>18.<strong>csscomb</strong> &#x2F;&#x2F;css自动兼容前缀</p>
<p>19.<strong>Live Sass Compiler</strong> &#x2F;&#x2F;实时编译scss文件，需要结合live server_name</p>
<p>20.<strong>ApiDoc Snippets</strong> &#x2F;&#x2F;后端api文档生成器提示，apidoc -i 入口文件 -o 出口文件</p>
</div>
]]></content>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>package.json</title>
    <url>/hexo-blog/2022/04/07/package-json/</url>
    <content><![CDATA[<div class="note simple"><h2 id="浏览器兼容性"><a href="#浏览器兼容性" class="headerlink" title="浏览器兼容性"></a><mark class="hl-label green">浏览器兼容性</mark></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;browserslist&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;production&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;&gt;0.2%&quot;</span>,</span><br><span class="line">      <span class="string">&quot;not dead&quot;</span>,</span><br><span class="line">      <span class="string">&quot;not op_mini all&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;development&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;last 1 chrome version&quot;</span>,</span><br><span class="line">      <span class="string">&quot;last 1 firefox version&quot;</span>,</span><br><span class="line">      <span class="string">&quot;last 1 safari version&quot;</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><h2 id="前端常用插件包"><a href="#前端常用插件包" class="headerlink" title="前端常用插件包"></a><mark class="hl-label green">前端常用插件包</mark></h2><h3 id="通用"><a href="#通用" class="headerlink" title="通用"></a>通用</h3><p>“json server”:,<br>“cross-env”:,</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//常规</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;build&quot;</span>: <span class="string">&quot;cross-env NODE_ENV=production webpack --config build/webpack.config.js&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以给NODE环境设置一个变量，通过process.env.xxxxx来获取，我们根据相对应的变量进行不同的配置。</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;dev:oneProject&quot;</span>: <span class="string">&quot;cross-env PROJECT_NAME=oneProject vue-cli-service serve&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//这个段代码我们设置了一个PROJECT_NAME的变量，通过process.env.PROJECT_NAME来获取到变量的值oneProject 。</span></span><br></pre></td></tr></table></figure>
"mockjs": ,
"classnames":,
"nprogress": ,
"moment":,
"axios": ,
"lodash":,
"echarts": ,
"braft-editor":,
"react-draft-wysiwyg":,
"draft-js": "^0.11.7",
"draftjs-to-html": ,
"html-to-draftjs": ,
"http-proxy-middleware": ,
### react
"react": ,
"redux-persist":
"react-custom-scrollbars": ,
"react-dom": ,
"react-dom-router": ,
"react-helmet": ,
"redux": ,
"react-redux": ,
"@reduxjs/toolkit": ,
"react-router-dom": ,
"react-scripts": ,
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;start&quot;</span>: <span class="string">&quot;react-scripts start&quot;</span>,</span><br><span class="line"><span class="string">&quot;build&quot;</span>: <span class="string">&quot;react-scripts build&quot;</span>,</span><br><span class="line"><span class="string">&quot;test&quot;</span>: <span class="string">&quot;react-scripts test&quot;</span>,</span><br><span class="line"><span class="string">&quot;eject&quot;</span>: <span class="string">&quot;react-scripts eject&quot;</span></span><br></pre></td></tr></table></figure>

<p>“antd”: ,<br>“sass”: ,<br>“sass-loader”: ,<br>“@umijs&#x2F;plugin-sass”:,</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>umi中需要在config中加入:</span><br><span class="line"><span class="attr">sass</span>:&#123;&#125;</span><br><span class="line"><span class="number">2.</span>在typings.<span class="property">d</span>.<span class="property">ts</span>中加入：</span><br><span class="line">declare <span class="variable language_">module</span> <span class="string">&#x27;*.scss&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">content</span>: any;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> content;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>“react-highlight-words”:,</p>
<p>“react-custom-scrollbars”:,</p>
<h3 id="umi"><a href="#umi" class="headerlink" title="umi"></a>umi</h3><p> “@umijs&#x2F;plugin-qiankun”: ,<br> <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> <span class="number">1.</span>基座</span><br><span class="line"> (<span class="number">1</span>)<span class="attr">qiankun</span>: &#123;</span><br><span class="line">        <span class="attr">master</span>: &#123;</span><br><span class="line">            <span class="comment">// 注册子应用信息</span></span><br><span class="line">            <span class="attr">apps</span>: [</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&#x27;app2&#x27;</span>, <span class="comment">// 唯一 id</span></span><br><span class="line">                    <span class="attr">entry</span>: <span class="string">&#x27;<a href="http://localhost:3000&amp;#x27">http://localhost:3000&amp;#x27</a>;</span>, <span class="comment">// html entry</span></span><br><span class="line">                &#125;,</span><br><span class="line">            ],</span><br><span class="line">            <span class="comment">//   jsSandbox: true, // 是否启用 js 沙箱，默认为 false</span></span><br><span class="line">            <span class="comment">//   prefetch: true, // 是否启用 prefetch 特性，默认为 true</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)routes</span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="string">&#x27;/src/pages/index.tsx&#x27;</span>,</span><br><span class="line">        <span class="attr">routes</span>:[</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">path</span>: <span class="string">&#x27;/app2&#x27;</span>,</span><br><span class="line">                <span class="attr">microApp</span>: <span class="string">&#x27;app2&#x27;</span></span><br><span class="line">            &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br><span class="line"><span class="number">2.</span>子应用</span><br><span class="line">(<span class="number">1</span>)config</span><br><span class="line"><span class="comment">//注册qiankun应用</span></span><br><span class="line">    <span class="attr">qiankun</span>: &#123;</span><br><span class="line">        <span class="attr">slave</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">(<span class="number">2</span>)app.<span class="property">jsx</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> qiankun = &#123;</span><br><span class="line">    <span class="comment">// 应用加载之前</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">bootstrap</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;app2 bootstrap&#x27;</span>, props);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 应用 render 之前触发</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">mount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;app2 mount&#x27;</span>, props);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 应用卸载之后触发</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">unmount</span>(<span class="params">props</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;app2 unmount&#x27;</span>, props);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">(<span class="number">3</span>)package.<span class="property">json</span></span><br><span class="line"><span class="attr">name</span>:app2</span><br><span class="line"> </span><br></pre></td></tr></table></figure></p>
<p>“@umijs&#x2F;preset-react”: ,</p>
<p>“@umijs&#x2F;preset-ui”: ,</p>
<p>“@umijs&#x2F;test”: ,</p>
<p>“@ant-design&#x2F;pro-cli”:,</p>
</div>



<div class="note simple"><p>##<mark class="hl-label green">后端常用包</mark> </p>
<p>“jsonwebtoken”: ,</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 引入jwt-token鉴权</span></span><br><span class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">&#x27;jsonwebtoken&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> secret=<span class="string">&#x27;qqasfsfafsdfsdfsdffdsfsdf&#x27;</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">JWT</span>=&#123;</span><br><span class="line">    <span class="title function_">generate</span>(<span class="params">value,expires</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> jwt.<span class="title function_">sign</span>(value,secret,&#123;<span class="attr">expiresIn</span>:expires&#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">verify</span>(<span class="params">token</span>)&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> jwt.<span class="title function_">verify</span>(token,secret)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="variable constant_">JWT</span></span><br></pre></td></tr></table></figure>
 "apidoc": "^0.52.0",
 <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>根目录建立apidoc.<span class="property">json</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>:<span class="string">&quot;myapp接口文档&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>:<span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;description&quot;</span>:<span class="string">&quot;关于...的接口文档说明&quot;</span>,</span><br><span class="line">    <span class="string">&quot;title&quot;</span>:<span class="string">&quot;企业系统&quot;</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="number">2.</span>命令行输入 apidoc -i 入口文件 -o 出口文件</span><br></pre></td></tr></table></figure>
"cookie-parser": ,

<p>“debug”: ,</p>
<p>“ejs”: ,</p>
<p>“express”: ,</p>
<p>“http-errors”: ,</p>
<p>“mongoose”: ,</p>
<p>“morgan”: ,</p>
<p>“multer”: ,</p>
<p>“socket.io”: ,</p>
<p>“nodemon”:,</p>
<p>“mysql2”</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;start&quot;</span>: <span class="string">&quot;nodemon ./bin/www&quot;</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><h2 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a><mark class="hl-label green">hexo</mark></h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;hexo&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-deployer-git&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-archive&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-category&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-index&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-json-content&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-searchdb&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-generator-tag&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-renderer-ejs&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-renderer-marked&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-renderer-pug&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-renderer-stylus&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-server&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-theme-fluid&quot;</span>: ,</span><br><span class="line"><span class="string">&quot;hexo-theme-landscape&quot;</span>: </span><br></pre></td></tr></table></figure></div>
]]></content>
      <tags>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>阿里云oss存储</title>
    <url>/hexo-blog/2022/06/07/%E9%98%BF%E9%87%8C%E4%BA%91oss%E5%AD%98%E5%82%A8/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">常规配置</mark> </p>
<figure class="highlight console"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ssh root@ip地址  </span><br><span class="line">密码 //大小写数字</span><br><span class="line"></span><br><span class="line">//进入之后</span><br><span class="line">apt update</span><br><span class="line">apt install git</span><br><span class="line">curl -sL https://deb.nodesource.com/setup_16.x | sudo -E bash -</span><br><span class="line">apt install nodejs</span><br><span class="line">apt install yarn</span><br><span class="line">apt install nginx</span><br><span class="line"></span><br><span class="line">//加上sudo表示管理员</span><br><span class="line"></span><br><span class="line">//卸载yarn</span><br><span class="line">apt remove testcmd</span><br><span class="line">apt remove yarn</span><br><span class="line">npm i yarn -g</span><br></pre></td></tr></table></figure></div>
]]></content>
      <tags>
        <tag>oss</tag>
      </tags>
  </entry>
  <entry>
    <title>webpack</title>
    <url>/hexo-blog/2022/07/07/webpack/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">webpack.config.js</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;html-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; <span class="title class_">CleanWebpackPlugin</span> &#125; = <span class="built_in">require</span>(<span class="string">&quot;clean-webpack-plugin&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="comment">// 指定入口文件</span></span><br><span class="line">    <span class="comment">// 这里我们在src文件夹下创建一个index.ts</span></span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&quot;./src/index.js&quot;</span>,</span><br><span class="line">    <span class="comment">// 指定输出文件名</span></span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">        <span class="attr">filename</span>: <span class="string">&quot;main.js&quot;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">module</span>: &#123;</span><br><span class="line">        <span class="comment">// 配置以.ts/.tsx结尾的文件都用ts-loader解析</span></span><br><span class="line">        <span class="comment">// 这里我们用到ts-loader，所以要安装一下</span></span><br><span class="line">        <span class="comment">// npm install ts-loader -D</span></span><br><span class="line">        <span class="attr">rules</span>: [&#123; <span class="comment">//css</span></span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                <span class="attr">use</span>: [</span><br><span class="line">                    <span class="comment">// &#x27;style-loader&#x27;,</span></span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123; <span class="comment">//less</span></span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">                <span class="attr">use</span>: [</span><br><span class="line">                    <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;css-loader&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;scss-loader&#x27;</span></span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">test</span>: <span class="regexp">/\.(jpg|png|gif)$/</span>,</span><br><span class="line">                <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">                <span class="attr">options</span>: &#123;</span><br><span class="line">                    <span class="attr">name</span>: <span class="string">&quot;[name].[ext]&quot;</span>,</span><br><span class="line">                    <span class="attr">outputPath</span>: <span class="string">&#x27;imgs/&#x27;</span>,</span><br><span class="line">                    <span class="attr">publicPath</span>: <span class="string">&#x27;./dist/imgs/&#x27;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 指定编译后是否生成source-map，这里判断如果是生产打包环境则不生产source-map</span></span><br><span class="line">    <span class="attr">devtool</span>: process.<span class="property">env</span>.<span class="property">NODEENV</span> === <span class="string">&quot;production&quot;</span> ? <span class="literal">false</span> : <span class="string">&quot;inline-source-map&quot;</span>,</span><br><span class="line">    <span class="comment">// 这里使用webpack-dev-server，进行本地开发调试</span></span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">contentBase</span>: <span class="string">&quot;./dist&quot;</span>,</span><br><span class="line">        <span class="attr">stats</span>: <span class="string">&quot;errors-only&quot;</span>,</span><br><span class="line">        <span class="attr">compress</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">host</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">        <span class="attr">port</span>: <span class="number">8089</span>,</span><br><span class="line">        <span class="attr">open</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 这里用到两个插件，所以首先我们要记着安装</span></span><br><span class="line">    <span class="comment">// npm install html-webpack-plugin clean-webpack-plugin -D</span></span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        <span class="comment">// 这里在编译之前先删除dist文件夹</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">CleanWebpackPlugin</span>(&#123; <span class="attr">cleanStaleWebpackAssets</span>: <span class="literal">false</span> &#125;),</span><br><span class="line">        <span class="comment">// 这里我们指定编译需要用模板，模板文件是./src/template/index.html，所以接下来我们要创建一个index.html文件</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">            <span class="attr">template</span>: <span class="string">&quot;./src/index.html&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;development&#x27;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div>
<div class="note simple"><p><mark class="hl-label green">依赖</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;clean-webpack-plugin&quot;</span>: <span class="string">&quot;^4.0.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;css-loader&quot;</span>: <span class="string">&quot;^6.7.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;file-loader&quot;</span>: <span class="string">&quot;^6.2.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;html-webpack-plugin&quot;</span>: <span class="string">&quot;^5.5.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;style-loader&quot;</span>: <span class="string">&quot;^3.3.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;webpack-cli&quot;</span>: <span class="string">&quot;^4.9.2&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;@babel/core&quot;</span>: <span class="string">&quot;^7.17.10&quot;</span>,</span><br><span class="line">        <span class="string">&quot;@babel/preset-env&quot;</span>: <span class="string">&quot;^7.17.10&quot;</span>,</span><br><span class="line">        <span class="string">&quot;babel-loader&quot;</span>: <span class="string">&quot;^8.2.5&quot;</span>,</span><br><span class="line">        <span class="string">&quot;html-loader&quot;</span>: <span class="string">&quot;^3.1.0&quot;</span>,</span><br><span class="line">        <span class="string">&quot;scss-loader&quot;</span>: <span class="string">&quot;^0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;webpack-dev-server&quot;</span>: <span class="string">&quot;^4.9.0&quot;</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div>

]]></content>
      <tags>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>框架安装</title>
    <url>/hexo-blog/2022/08/07/%E6%A1%86%E6%9E%B6%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">CreateReactApp</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npx create-react-app my-app</span><br><span class="line">cd my-app</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">umijs</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">yarn create @umijs/umi-app</span><br><span class="line">yarn</span><br><span class="line">yarn start</span><br><span class="line"><span class="comment">//yarn build</span></span><br><span class="line"><span class="comment">//yarn add @umijs/preset-ui -D //umi-ui</span></span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">antdPro</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm i @ant-design/pro-cli -g</span><br><span class="line">pro create myapp</span><br></pre></td></tr></table></figure></div>

<div class="note simple"><p><mark class="hl-label green">本地静态网站部署</mark> </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$ yarn <span class="variable language_">global</span> add serve</span><br><span class="line">$ serve ./dist</span><br><span class="line"></span><br><span class="line">   ┌────────────────────────────────────────────────────┐</span><br><span class="line">   │                                                    │</span><br><span class="line">   │   <span class="title class_">Serving</span>!                                         │</span><br><span class="line">   │                                                    │</span><br><span class="line">   │   - <span class="title class_">Local</span>:            <span class="attr">http</span>:<span class="comment">//localhost:5000        │</span></span><br><span class="line">   │   - <span class="title class_">On</span> <span class="title class_">Your</span> <span class="title class_">Network</span>:  <span class="attr">http</span>:<span class="comment">//192.168.12.34:5000    │</span></span><br><span class="line">   │                                                    │</span><br><span class="line">   │   <span class="title class_">Copied</span> local address to clipboard!               │</span><br><span class="line">   │                                                    │</span><br><span class="line">   └────────────────────────────────────────────────────┘</span><br></pre></td></tr></table></figure></div>

]]></content>
      <tags>
        <tag>框架安装</tag>
      </tags>
  </entry>
  <entry>
    <title>拖拽</title>
    <url>/hexo-blog/2022/08/09/%E6%8B%96%E6%8B%BD/</url>
    <content><![CDATA[<div class="note simple"><p><mark class="hl-label green">拖拽库</mark><br><a href="https://interactjs.io/">interactjs</a></p>
</div>

<div class="note simple"><p><mark class="hl-label green">简单拖拽实现</mark> </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>drag<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1,user-scalable=no&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">&quot;container&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;height: 300px; width: 400px; background-color: green&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;rec&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;rec&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 50px; height: 80px; background-color: #f0f0f0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">draggable</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">&quot;got&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">&quot;height: 300px; width: 400px; background-color: gray&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> container = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;container&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> got = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;got&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> rec = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;rec&quot;</span>)[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> recInfor = rec.<span class="title function_">getBoundingClientRect</span>();</span></span><br><span class="line"><span class="language-javascript">      rec.<span class="property">ondragstart</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> eid = e.<span class="property">target</span>.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a&quot;</span>, eid);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// event.dataTransfer.effectAllowed=&#x27;move&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        event.<span class="property">dataTransfer</span>.<span class="title function_">setData</span>(<span class="string">&quot;text/plain&quot;</span>, eid);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      got.<span class="property">ondragover</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      got.<span class="property">ondrop</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> eid = e.<span class="property">dataTransfer</span>.<span class="title function_">getData</span>(<span class="string">&quot;text/plain&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> dragItem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(eid);</span></span><br><span class="line"><span class="language-javascript">        e.<span class="property">target</span>.<span class="title function_">appendChild</span>(dragItem);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;b&quot;</span>, eid);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      container.<span class="property">ondragover</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      container.<span class="property">ondrop</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> eid = e.<span class="property">dataTransfer</span>.<span class="title function_">getData</span>(<span class="string">&quot;text/plain&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> dragItem = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(eid);</span></span><br><span class="line"><span class="language-javascript">        e.<span class="property">target</span>.<span class="title function_">appendChild</span>(dragItem);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;b&quot;</span>, eid);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;ul&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: lightgray&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i1&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i2&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i3&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i4&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i5&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;i6&quot;</span>&gt;</span>6<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> ul = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;ul&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> lilist = [...<span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;li[class^=&quot;i&quot;]&#x27;</span>)];</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> li <span class="keyword">of</span> lilist) &#123;</span></span><br><span class="line"><span class="language-javascript">        li.<span class="property">draggable</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> li <span class="keyword">of</span> lilist) &#123;</span></span><br><span class="line"><span class="language-javascript">        li.<span class="property">ondragstart</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;e&#x27;</span>,e)</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">let</span> liid = e.<span class="property">target</span>.<span class="property">className</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a&quot;</span>, liid);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">          e.<span class="property">dataTransfer</span>.<span class="title function_">setData</span>(<span class="string">&quot;text/plain&quot;</span>, liid);</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      ul.<span class="property">ondragover</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        e.<span class="title function_">preventDefault</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      ul.<span class="property">ondrop</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> liid = e.<span class="property">dataTransfer</span>.<span class="title function_">getData</span>(<span class="string">&quot;text/plain&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;b&quot;</span>, liid);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> dragItem = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">`.<span class="subst">$&#123;liid&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">        e.<span class="property">target</span>.<span class="title function_">insertAdjacentElement</span>(<span class="string">&#x27;afterend&#x27;</span>,dragItem)</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>
]]></content>
      <tags>
        <tag>dragAndDrop</tag>
      </tags>
  </entry>
</search>
